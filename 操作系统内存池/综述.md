# 操作系统内存池

## 概念

狭义内存池是指一种对操作系统内存的管理方式，它通过一次性向操作系统申请一大块内存，然后采用更针对应用的管理方式，以提高内存的使用效率。

通常我们习惯采用new、delete等方式申请和分配内存，这样做的缺点在于所申请内存块的大小不定，当频繁使用时会造成大量的内存碎片并进而降低性能。

内存池会根据应用的特点将内存按照适合的粒度管理，从而提高空间利用率和使用效率。

这是我们通常的使用方式，也是单机的。C++就有提供内存池相关的库。关于如何使用C++实现一个经典的内存池，可以参考这里[^C++经典内存池][^C++一般内存池]。

[^C++经典内存池]: [C++ 内存池介绍与经典内存池的实现](https://blog.csdn.net/K346K346/article/details/49538975#:~:text=%E5%86%85%E5%AD%98%E6%B1%A0%E5%88%99%E6%98%AF%E5%9C%A8,%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D%E6%95%88%E7%8E%87%E5%BE%97%E5%88%B0%E6%8F%90%E5%8D%87%E3%80%82)

[^C++一般内存池]: [C++ 应用程序性能优化，第 6 章：内存池](https://www.ibm.com/developerworks/cn/linux/l-cn-ppp/index6.html)

## 分类

1. 从线程安全的角度：

   - 单线程内存池
   - 多线程内存池

    相对而言，单线程内存池性能更高，而多线程内存池适用范围更加广泛。

2. 从分配单元的角度：

    - 固定内存池：每次从内存池中分配出来的内存单元大小事先已经确定，是固定不变的
    - 可变内存池：每次分配的内存单元大小可以按需变化

    可变内存池应用范围更广，而性能比固定内存池要低。

## 内存池技术

内存池技术因为其对内存管理有着显著的优点，在各大项目中广泛应用，备受推崇。内存池通常用于管理小内存分配的，以减少内存碎片、操作系统调用次数。

经典内存池技术，是一种用于分配大量大小相同(通常不相等)的**小对象**的技术。



